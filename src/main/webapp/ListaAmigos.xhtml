<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <f:view contentType="text/html">
        <h:head>
            <f:facet name="first">
                <meta content='text/html; charset=UTF-8' http-equiv="Content-Type"/>
                <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css"/>
                <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
                <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
                <link rel="stylesheet" href="css/styles.css"/>
                <title>Lista amigos</title>
            </f:facet>
        </h:head>
        <h:body id="body">
            <script>
                (function (d, s, id) {
                    var js, fjs = d.getElementsByTagName(s)[0];
                    if (d.getElementById(id))
                        return;
                    js = d.createElement(s);
                    js.id = id;
                    js.src = "https://connect.facebook.net/en_US/sdk.js";
                    fjs.parentNode.insertBefore(js, fjs);
                }(document, 'script', 'facebook-jssdk'));

                window.fbAsyncInit = function () {
                    FB.init({
                        appId: '1943608085935991',
                        cookie: true, // enable cookies to allow the server to access 
                        autoLogAppEvents: true,
                        status: true,
                        xfbml: true, // parse social plugins on this page
                        version: 'v3.2' // use graph api version 2.0
                    });

                    FB.getLoginStatus(function (response) {
                        listaAmigos();
                    });
                };



                function listaAmigos() {
                    FB.api("/me/friends", "GET", {"fields": "id,name"}, function (response) {
                        if (response || !response.error) {
                            var Personas = [];
                            for (var infoPersonaGen in response.data) {
                                for (var infoPersonaEspe in infoPersonaGen) {
                                    var newPersona = [];
                                    var Id = newPersona.push(response.data[infoPersonaEspe].id);
                                    var Name = newPersona.push(response.data[infoPersonaEspe].name);
                                    var Persona = Personas.push(newPersona);
                                }
                            }
                            Personas.forEach(function (item, index, array) {
                                console.log(item, index);
                                document.write(Personas);
                            });
                        }
                        construirAmigos(Personas);

                    }
                    );
                }

                function contruirAmigos(Personas) {
                    
                    Personas.forEach(function (item, index, array) {
                                let persona =
                            '<h3>' + Persona + '</h3>'
                            + '<ul class="list-group">' +
                            '<li class="list-group-item">' + 'User ID: ' + Personas[item].[0] + '</li>' +
                            '<li class="list-group-item">' + 'Name: ' + Personas[item].[1] + '</li>' +
                            '</ul>'
                            ;
                            
                            document.getElementById('Amigos').innerHTML = persona;
                            });
                }



            </script>

            <h:form>  
                <p:menubar>
                    <p:menuitem value="Inicio" icon="ui-icon-home" url="landing.xhtml"/>
                </p:menubar>
            </h:form>

            <p:panel><h3>Amigos</h3></p:panel>

            <h:form> 
                <p:dataScroller  id="amigos" var="Amigo" chunkSize="10">
        <f:facet name="header">
            Ve abajo para ver mas amigos
        </f:facet>
 
        <h:panelGrid columns="2" style="width:100%" columnClasses="logo,detail">
            <p:graphicImage name="" /> 
 
            <p:outputPanel>
                <h:panelGrid columns="2" cellpadding="5">
                    <h:outputText value="Id:" />
                    <h:outputText value="#{Amigo}" style="font-weight: bold"/>
                </h:panelGrid>
            </p:outputPanel>
        </h:panelGrid>
    </p:dataScroller>
</h:form>
            
        </h:body>
    </f:view>
</html>
